var Config,Keys,Width;Config={cdn:"//cdn.spiffy.io/static"},Keys={left:37,right:39},Width={xs:320,sm:480,md:768,lg:992,xl:1200};var blank,confirmation,contains,defined,go,handler,high,initModalSize,medium,overrideHandler,preventDefault,quality,recaptchaCallback,refresh;recaptchaCallback=function(){$(".g-recaptcha").each(function(t,n){grecaptcha.render(n,{sitekey:"6LeSviITAAAAAFC9aCd6CAmWFqLoIpzw174jMc-i"})})},preventDefault=function(t){t.preventDefault()},overrideHandler=refresh,handler=function(t){return defined(t)&&(overrideHandler=t),defined(overrideHandler)?overrideHandler:refresh},medium=function(t){quality(t,"m",["a","l"],function(){high(t)})},high=function(t){quality(t,"h",["a","l","m"])},quality=function(t,n,e,i){var a,o,r,d,l;for(null==e&&(e=["a","l","m","h"]),l=t.attr("src"),o=0,r=e.length;r>o;o++)d=e[o],l=l.replace("q="+d,"q="+n);a=new Image,a.onload(function(){t.remove("lazy").attr("src",l),null!=i&&i()}),a.src=l},confirmation=function(t,n){var e;e=$("#confirmation"),e.find(".modal-title").text(t),e.find(".continue").on("click",function(t){return t.preventDefault(),n()}),e.modal("show")},go=function(t){return location.href=t},refresh=function(){return location.reload(!0),window.location=self.location},blank=function(t){return defined(t)?""===t:!0},defined=function(t){return"undefined"==typeof t?!1:"undefined"!==t},contains=function(t,n){var e;return e=t.indexOf(n),e>-1},initModalSize=function(){var t;return t=$(window).height()-125+"px",$(".modal-body").css("max-height",t),t};var Spiffy,base,base1,base2,base3,base4;null==(base=Array.prototype).isArray&&(base.isArray=function(){return"[object Array]"==={}.toString.call(value)}),null==(base1=String.prototype).startsWith&&(base1.startsWith=function(t){return this.slice(0,t.length)===t}),null==(base2=String.prototype).endsWith&&(base2.endsWith=function(t){return""===t||this.slice(-t.length)===t}),null==(base3=String.prototype).contains&&(base3.contains=function(t){return""===t||this.indexOf(t)>-1}),null==(base4=String.prototype).equalsIgnoreCase&&(base4.equalsIgnoreCase=function(t){return this.toUpperCase()===t.toUpperCase()}),Spiffy={firstDefined:function(){var t,n,e;for(e=arguments.length-1;e>=0;e+=-1)t=arguments[e],null!=t&&(n=t);return null!=n?n:void 0}},jQuery.fn.spiffy=function(){var t,n;return t=$(this),n={end:function(){return t},disable:function(){return t.find("form, input, textarea, select, button").addBack().prop("disabled",!0).attr("data-disabled",!0),t.spiffy()},enable:function(){return t.find("form, input, textarea, select, button").addBack().removeAttr("disabled").removeAttr("data-disabled"),t.spiffy()},clear:function(){return t.find("input, textarea").val(""),t.spiffy()},push:function(n){var e,i,a;return e=$(t[0]),i=e.attr("name"),a=e.val(),null==n[i]?n[i]=a:Array.isArray(n[i])?n[i].push(a):n[i]=[n[i],a],n},data:function(){var n,e,i,a;if(t.length>1){for(n=[],i=0,a=t.length;a>i;i++)e=t[i],n.push($(e).spiffy().data());return n}return e=$(t[0]),e.is("form")?(n={},e.find("[name]").each(function(){return $(this).spiffy().push(n)}),$('[data-form-name="'+e.data("name")+'"]').each(function(){return $(this).spiffy().push(n)}),n):n=e.val()},options:function(n){var e;return e=$(t[0]),e.is("form")?null!=n?(e.data("options",n),e.spiffy()):e.data("options"):void 0},submit:function(n){var e,i,a,o,r,d,l,s,f,u;return o=$(t[0]),!o.is("form")||o.data("disabled")||(n=Spiffy.firstDefined(n,$(o).spiffy().options(),{}),u=o.validate(Spiffy.firstDefined(n.validate,{})),u.numberOfInvalids())?void 0:(f=Spiffy.firstDefined(n.url,o.data("url"),o.attr("action")),s=Spiffy.firstDefined(n.type,o.data("type"),o.attr("method"),"POST"),e=o.data("csrf-token"),null==e&&s.equalsIgnoreCase("POST")&&alert("csrf required"),a=Spiffy.firstDefined(n.disable,!0),a&&o.spiffy().disable(),d=Spiffy.firstDefined(n.loading,o.data("loading"),"overlay"),"overlay".equalsIgnoreCase(d)?(r=o.find("img.loading"),null!=r&&r.is("img.loading")||(o.css("position","relative"),r=$(document.createElement("img")),r.addClass("loading"),r.attr("src","https://cdn.spiffy.io/static/svg/loading.svg"),r.prop("hidden"),o.append(r)),r.slideDown()):"header".equalsIgnoreCase(d)&&(r=$("img.header-logo"),l=r.attr("src"),l=l.replace("icon","loading"),r.attr("src",l)),i=o.spiffy().data(),$.ajax({url:f,data:i,dataType:"json",headers:{"X-CSRF-Token":e},type:s,success:function(t){return console.log(t)},error:function(t){return console.log(t.responseJSON)}}),o.spiffy())}}};var adjustColumns,closeModal,emptyColumn,fillColumn,fingerprint,load,loadPosts,openModal,sortColumn;Dropzone.options.dzForm={paramName:"file",maxFiles:1,maxFilesize:20,accept:function(t,n){n()},success:function(t,n){var e;e=$("form.submit").find('input[name="media"]'),e.val().length?e.val(e.val()+","+n.id):e.val(n.id)}},$(document).ready(function(){var t;$("div.header").mouseenter(function(){$(this).is(":hover")&&$(this).removeClass("hidden")}),$("div.header").mouseleave(function(){var t,n;n=$(this),t=function(){!n.is(":hover")&&$(window).scrollTop()>400&&n.addClass("hidden")},setTimeout(t,500)}),$("[data-modal]").click(function(){openModal($(this).data("modal"))}),$("[data-uri]").click(function(){go($(this).data("uri"))}),$("[data-post]").click(function(){go("/stream/"+$(this).data("post"))}),$('input[name="fingerprint"]')&&(t=fingerprint(),null!=t&&$('input[name="fingerprint"]').each(function(){$(this).val(t)})),$("form:not(#dz-form)").submit(function(t){var n;preventDefault(t),n=$(this),n.spiffy().submit()}),$("a[data-form]").click(function(t){var n;preventDefault(t),n=$("form."+$(this).data("form")),n.submit()}),$("a[data-session-id]").click(function(t){var n;preventDefault(t),n=$("form.logout"),n.find('input[name="session"]').val($(this).data("session-id")),n.submit()}),$(".close").click(function(){closeModal()}),$(".modal-overlay").click(function(t){$(t.target).hasClass("modal-overlay")&&closeModal()}),adjustColumns()}),openModal=function(t){$('[data-modal-id="'+t+'"]').length&&($("[data-modal-id]").not('[data-modal-id="'+t+'"]').hide(0),$('[data-modal-id="'+t+'"]').show(0),$(".modal-overlay").show(0),$(".modal").slideDown(500))},closeModal=function(){$(".modal").slideUp(250,function(){return $("[data-modal-id]").hide(0),$(".modal-overlay").hide(0)})},fingerprint=function(){var t,n;return t=sessionStorage.getItem("fingerprint"),null!=t?t:(n={excludeAdBlock:!0,excludeAvailableScreenResolution:!0},new Fingerprint2(n).get(function(t){sessionStorage.setItem("fingerprint",t),$('input[name="fingerprint"]').each(function(){$(this).val(t)})}),null)},load=function(t){var n;loadPosts(t.posts),$("[data-post]").click(function(){go("/stream/"+$(this).data("post"))}),n=$("form.load-posts").find('input[name="after"]').val(),$("form.load-posts").find('input[name="after"]').val(t.next),adjustColumns(),history.replaceState(t,"SPIFFY.io","/stream?start="+n)},loadPosts=function(t){var n,e,i,a,o,r,d,l;for(i=o=0,l=t.length;l>=0?l>o:o>l;i=l>=0?++o:--o)d=t[i],r=$(document.createElement("div")),r.addClass("panel"),r.attr("data-post",d.postId),a=$(document.createElement("img")),a.attr("src",d.url),r.append(a),e=$(document.createElement("div")),e.addClass("footer"),e.html(d.title),r.append(e),n=$('.col[data-index="'+i%3+'"]'),n.append(r)},adjustColumns=function(){$(".col").each(function(t){var n;$(this).attr("data-index",t),n=t,$(this).find(".panel").each(function(t){$(this).attr("data-index",$(".col").length*t+n)})}),$(window).width()<Width.xl&&emptyColumn(2),$(window).width()<Width.md&&emptyColumn(1)},emptyColumn=function(t){var n,e;n=$('.col[data-index="'+t+'"]'),e=n.find(".panel"),e.length&&(e.each(function(){var n,e;e=$(this),n=e.data("index"),n=1===t||n%2===0?n-1:n-2,e.detach().insertAfter('.panel[data-index="'+n+'"]')}),sortColumn(1))},fillColumn=function(t){var n,e;n=$('.col[data-index="'+t+'"]'),e=n.find(".panel"),e.length||(n=$('.col[data-index!="'+t+'"]'),e=n.find(".panel"),e.each(function(){var n;n=$(this),n.data("index")%3===t&&n.detach().appendTo('.col[data-index="'+t+'"]')}),sortColumn(t))},sortColumn=function(t){var n,e,i;n=$('.col[data-index="'+t+'"]'),e=n.find(".panel"),i=e.sort(function(t,n){return $(t).data("index")-$(n).data("index")}),n.html(i)},$(window).resize(function(){var t;t=$(window).width(),t>window.pWidth&&t>=Width.md&&($(".subheader").show(),fillColumn(1)),t<window.pWidth&&t<Width.md&&($(".subheader").hide(),$(".hamburger").removeClass("active"),emptyColumn(1)),t>window.pWidth&&t>=Width.xl&&fillColumn(2),t<window.pWidth&&t<Width.xl&&emptyColumn(2),window.pWidth=t}),$(window).scroll(function(){$(window).scrollTop()>400?$("div.header").addClass("hidden"):$("div.header").removeClass("hidden"),$("div.col").each(function(){var t,n;t=$(this),n=t.find("div.panel:last"),null!=n&&null!=n.offset()&&n.offset().top-n.height()<$(window).scrollTop()&&$("form.load-posts").submit()})}),$(window).on("beforeunload",function(){location.search.contains("start")&&$(window).scrollTop(0)});
