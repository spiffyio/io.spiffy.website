var Spiffy;Spiffy={},Spiffy.constants={},Spiffy.c=Spiffy.constants,Spiffy.c["enum"]={},Spiffy.c["enum"].loglevel={FATAL:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},Spiffy.c.param={ATTEMPT:1,ETAG:void 0},Spiffy.c.retry={MAX_COUNT:3,TIMEOUT:5e3},Spiffy.c.key={LEFT:37,RIGHT:39},Spiffy.c.size={},Spiffy.c.size.width={XS:320,SM:480,MD:768,LG:992,XL:120},Spiffy.c.config={CDN:"//cdn.spiffy.io",LOGLEVEL:Spiffy.c["enum"].loglevel.TRACE};var confirmation,dataURItoBlob,defined,go,handler,initModalSize,overrideHandler,preventDefault,refresh;Spiffy.functions={},Spiffy.f=Spiffy.functions,Spiffy.f.log=function(e,t){e<=Spiffy.c.config.LOGLEVEL&&console.log(t)},Spiffy.f.authenticated=function(){return 0!==$('meta[name="account"]').length},Spiffy.f.first=function(){var e,t,n;for(n=arguments.length-1;n>=0;n+=-1)e=arguments[n],null!=e&&(t=e);return t},Spiffy.f.firstDefined=Spiffy.f.first,Spiffy.firstDefined=Spiffy.f.firstDefined,Spiffy.f.click=function(e,t,n){null==n&&(n=!0),$(document).on("click",e,function(e){n&&Spiffy.f.prevent(e),t(e,$(this))})},Spiffy.f.prevent=function(e){e.preventDefault()},Spiffy.f.element={},Spiffy.f.element.template=function(e){var t;return t='[data-template="$name"]'.replace("$name",e),$(t)},Spiffy.f.timeout={},Spiffy.f.timeout.simple=function(e,t){setTimeout(t,e)},Spiffy.f.timeout.retry=function(e,t){return e>=Spiffy.c.retry.MAX_COUNT?void Spiffy.f.log(Spiffy.c["enum"].loglevel.ERROR,"max retry attempts exceeded... "+t):void setTimeout(t,Spiffy.c.retry.TIMEOUT*e*e)},Spiffy.f.update={},Spiffy.f.update.notifications=function(e){var t;t=$("span.notification-count"),0===e?(document.title="SPIFFY.io",t.html("")):(document.title="("+e+") SPIFFY.io",t.html(e))},Spiffy.f.update.poll=function(e,t){return null==e&&(e=Spiffy.c.param.ETAG),null==t&&(t=Spiffy.c.param.ATTEMPT),Spiffy.f.authenticated()?(Spiffy.f.log(Spiffy.c["enum"].loglevel.INFO,"polling..."+(null!=e?" [etag: "+e+"]":"")),$.get({url:"/longpoll",dataType:"json",cache:!1,beforeSend:function(t){null!=e&&t.setRequestHeader("If-None-Match",e)},success:function(e,t,n){Spiffy.f.update.notifications(e.notifications),Spiffy.f.update.poll(n.getResponseHeader("ETag"))},error:function(){Spiffy.f.timeout.retry(t,function(){Spiffy.f.update.poll(e,t+1)})}})):void Spiffy.f.log(Spiffy.c["enum"].loglevel.INFO,"polling disabled...")},preventDefault=function(e){Spiffy.f.prevent(e)},overrideHandler=refresh,handler=function(e){return defined(e)&&(overrideHandler=e),defined(overrideHandler)?overrideHandler:refresh},confirmation=function(e,t){var n;n=$("#confirmation"),n.find(".modal-title").text(e),n.find(".continue").on("click",function(e){return Spiffy.f.prevent(e),t()}),n.modal("show")},go=function(e){return location.href=e},refresh=function(){return location.reload(!0),window.location=self.location},defined=function(e){return"undefined"==typeof e?!1:"undefined"!==e},initModalSize=function(){var e;return e=$(window).height()-125+"px",$(".modal-body").css("max-height",e),e},dataURItoBlob=function(e){var t,n,a,i,o,s,r,d,l,f,c;for(f=e.split(","),d=f[0],i=f[1],t=d.containsIgnoreCase("base64")?atob(i):unescape(i),l=d.split(":")[1].split(";")[0],n=new Uint8Array(t.length),c=t.split(""),o=s=0,r=c.length;r>s;o=++s)a=c[o],n[o]=a.charCodeAt(0);return new Blob([n],{type:l})};var base,base1,base2,base3,base4,base5;null==(base=Array.prototype).isArray&&(base.isArray=function(){return"[object Array]"==={}.toString.call(value)}),null==(base1=String.prototype).startsWith&&(base1.startsWith=function(e){return this.slice(0,e.length)===e}),null==(base2=String.prototype).endsWith&&(base2.endsWith=function(e){return""===e||this.slice(-e.length)===e}),null==(base3=String.prototype).contains&&(base3.contains=function(e){return""===e||this.indexOf(e)>-1}),null==(base4=String.prototype).containsIgnoreCase&&(base4.containsIgnoreCase=function(e){return""===e||this.toUpperCase().indexOf(e.toUpperCase())>-1}),null==(base5=String.prototype).equalsIgnoreCase&&(base5.equalsIgnoreCase=function(e){return this.toUpperCase()===e.toUpperCase()}),Handlebars.spiffy={html:function(e,t){var n,a;return n=Spiffy.f.element.template(e),(a=Handlebars.compile(n.html()))(t)}},jQuery.fn.spiffy=function(){var e,t;return e=$(this),t={end:function(){return e},disable:function(){return e.find("form, input, textarea, select, button, div.g-recaptcha").addBack().not('[data-disabled="permanent"]').prop("disabled",!0).attr("data-disabled",!0).addClass("disabled").data("disabled",!0),e.spiffy()},enable:function(){return e.find("form, input, textarea, select, button, div.g-recaptcha").addBack().not('[data-disabled="permanent"]').removeAttr("disabled").removeAttr("data-disabled").removeClass("disabled").data("disabled",!1),e.spiffy()},clear:function(){return e.find("input, textarea").val(""),e.spiffy()},push:function(t){var n,a,i;return n=$(e[0]),a=n.attr("name"),i=n.val(),null==t[a]?t[a]=i:t[a]=t[a]+","+i,t},data:function(){var t,n,a,i;if(e.length>1){for(t=[],a=0,i=e.length;i>a;a++)n=e[a],t.push($(n).spiffy().data());return t}return n=$(e[0]),n.is("form")?(t={},n.find("[name]").each(function(){return $(this).spiffy().push(t)}),$('[data-form-name="'+n.data("name")+'"]').each(function(){return $(this).spiffy().push(t)}),t):t=n.val()},loading:function(t,n,a){var i,o,s,r;return null==n&&(n=!0),null==a&&(a=2e3),o=$(e[0]),o.is("form")?("overlay".equalsIgnoreCase(t)?(s=o.find("img.loading"),!n||null!=s&&s.is("img.loading")||(o.css("position","relative"),s=$(document.createElement("img")),s.addClass("loading"),s.attr("src","https://cdn.spiffy.io/static/svg/loading.svg"),s.prop("hidden"),o.append(s)),n&&null!=s&&s.is("img.loading")&&s.slideDown(),!n&&null!=s&&s.is("img.loading")&&s.slideUp()):"header".equalsIgnoreCase(t)&&(s=$("img.header-icon"),null!=s&&s.is("img.header-icon")&&(r=s.attr("src"),r=n?r.replace("icon","loading"):r.replace("loading","icon"),s.attr("src",r)),i=$("div.header-loading"),null!=i&&i.is("div.header-loading")&&(n?i.animate({width:"80%"},a):i.finish().animate({width:"100%"},250,"swing",function(){return i.animate({opacity:"0"},500,"swing",function(){return i.css("width","0%"),i.css("opacity","1")})}))),o.spiffy()):void 0},options:function(t){var n;return n=$(e[0]),n.is("form")?null!=t?(n.data("options",$.extend(n.data("options"),t)),n.spiffy()):n.data("options"):void 0},submit:function(t){var n,a,i,o,s,r,d,l,f;return r=$(e[0]),r.is("form")&&!r.data("disabled")?(t=Spiffy.firstDefined(t,$(r).spiffy().options(),{}),f=Spiffy.firstDefined(t.url,r.data("url"),r.attr("action")),f=f.startsWith("+")?window.location.pathname+f.substr(1):f,l=Spiffy.firstDefined(t.type,r.data("type"),r.attr("method"),"POST"),a=r.data("csrf-token"),null==a&&l.equalsIgnoreCase("POST")&&alert("csrf required"),null==t.confirm||r.data("confirmed")?(o=Spiffy.firstDefined(t.disable,!0),o&&r.spiffy().disable(),d=Spiffy.firstDefined(t.loading,r.data("loading"),"overlay"),r.spiffy().loading(d),s=r.find("div.message"),null!=s&&s.is("div.message")&&s.slideUp(),i=r.spiffy().data(),$.ajax({url:f,data:i,dataType:"json",headers:{"X-CSRF-Token":a},type:l,success:function(e,n,a){return r.spiffy().enable().loading(d,!1),null!=t.success?t.success(r,e,n,a):void 0},error:function(e,n,a){var i,o,l,f;return l=e.responseJSON,401===e.status&&null!=l.uri?void go(e.responseJSON.uri):(400===e.status&&null!=l.error&&(i=r.find('input[name="'+l.error+'"]'),null!=i&&i.is('input[name="'+l.error+'"]')?(s=i.parent(),f=s.find("span"),s.addClass("bt-flabels__error"),f.html(l.reason)):(s=r.find("div.message"),s.addClass("error"),s.html(l.reason),s.slideDown())),null!=l.tip&&(s=r.find("div.message"),s.addClass("tip"),s.html(l.tip),s.slideDown()),o=r.find(".g-recaptcha"),null!=o&&o.is(".g-recaptcha")&&grecaptcha.reset(),r.spiffy().enable().loading(d,!1),null!=t.error?t.error(r,e,n,a):void 0)}}),r.spiffy()):(n=$("#confirm-action"),n.html(t.confirm),n.click(function(){closeModal(),r.attr("data-confirmed",!0),r.submit(),r.attr("data-confirmed",!1)}),void openModal())):void 0}}},Spiffy.f.click('a[href="#"]',function(){return{}}),Spiffy.f.click("a.menu",function(e,t){var n;t.toggleClass("expanded"),n=t.parent().find(".sub-menu"),n.toggleClass("show")}),Spiffy.f.click("[data-go]",function(e,t){go(t.data("go")+location.search)}),Spiffy.f.click(".close",function(){closeModal()}),Spiffy.f.click(".modal-overlay",function(e){$(e.target).hasClass("modal-overlay")&&closeModal()}),Spiffy.f.click("div.pause, video",function(e,t){var n;n=t.parent().parent().find("video"),n.attr("data-clicked",!0),n[0].paused?(n[0].play(),n.parents("div.video:first").removeClass("paused")):(n[0].pause(),n.parents("div.video:first").addClass("paused"))});var Messenger;Spiffy.f.click(".chat-thread",function(e,t){Messenger.open(t)}),Spiffy.f.click(".new-message",function(){Messenger["new"]()}),window.addEventListener("popstate",function(){var e,t;t=window.location.pathname,e=t.split("/"),3!==!e.length&&e[1].equalsIgnoreCase("messages")&&Messenger.open($('[data-thread-id="'+e[2]+'"]'),!1)}),$(document).ready(function(){var e,t,n,a,i,o;a=$(".chat-thread.active"),t=a.data("thread-id"),o="/messages/"+t,i=window.location.pathname,n=i.split("/"),2===n.length&&n[1].equalsIgnoreCase("messages")&&history.replaceState({id:t},t,o),$("form.new").spiffy().options({success:function(e,t){e.find('input[type="text"]').val(""),t.thread.display="none",Messenger.addThread(t.thread),Messenger.open($('[data-thread-id="'+t.thread.id+'"]'))}}),$("form.message").spiffy().options({success:function(e,t){e.find('input[type="text"]').val(""),e.find('input[name="idempotentId"]').val(t.idempotentId),t.message.display="none",Messenger.addMessage(t.message),e.find('input[type="text"]').focus()}}),a=$(".chat-thread.active"),t=a.data("thread-id"),o="/messages/"+t,(e=function(){var t,n;if(a.hasClass("active"))return t={},n=$("[data-message-id]:first"),n.is("[data-message-id]:first")&&(t.after=n.data("message-id")),$.get({url:o,dataType:"json",data:t,cache:!1,success:function(t){return Messenger.loadMessages(t),setTimeout(e,1e4)}})})()}),Messenger={add:function(e,t,n,a){var i;i=$(t),i.is(t)||(e=$(e),e.prepend(Handlebars.spiffy.html(n,a)),i=$(t),i.slideDown(),i.animate({opacity:1},500))},addThread:function(e){Messenger.add(".chats-body",'[data-thread-id="'+e.id+'"]',"chat-thread",e)},addMessage:function(e){Messenger.add(".chat-body",'[data-message-id="'+e.id+'"]',"message-group",e)},"new":function(){var e,t;e=$("form.new"),t=e.parent().find(".title"),e.is(":visible")?Messenger.open($('[data-thread-id="'+t.html()+'"]')):Messenger.open($('[data-thread-id="new"]'))},loadMessages:function(e){var t,n,a,i;if(null!=e&&(i=e.messages,null!=i))for(t=0,n=i.length;n>t;t++)a=i[t],a.opacity="0.0",Messenger.addMessage(a)},open:function(e,t){var n,a,i,o,s,r,d,l,f,c;null==t&&(t=!0),e.length&&(e.hasClass("active")||($(".chat-thread.active").removeClass("active"),e.addClass("active"),d=e.data("thread-id"),c="/messages/"+d,t&&history.pushState({id:d},d,c),d.equalsIgnoreCase("new")||(i=!0,(s=function(){var t,n;if(e.hasClass("active"))return t={},i?i=!1:(n=$("[data-message-id]:first"),n.is("[data-message-id]:first")&&(t.after=n.data("message-id"))),$.get({url:c,dataType:"json",data:t,cache:!1,success:function(e){return Messenger.loadMessages(e),setTimeout(s,1e4)}})})()),a=$(".chat"),r=a.find(".chat-header"),o=r.find("form"),f=r.find(".title"),d.equalsIgnoreCase("new")?(f.hide(),o.show(),l=o.find("input")):(f.html(d).show(),o.hide(),l=$("form.message").find('[name="message"]')),l.focus(),n=a.find(".chat-body"),n.html("")))}};var initBannerDZ,initIconDZ;Dropzone.autoDiscover=!1,$(document).ready(function(){return $("form#icon-dz").length&&initIconDZ(),$("form#banner-dz").length?initBannerDZ():void 0}),initIconDZ=function(){var e,t,n,a;return t=$(".icon-container"),e=new Croppie(t.find(".spiffy-croppie")[0],{enableOrientation:!0,viewport:{width:160,height:160,type:"square"}}),t.find(".button.primary").click(function(){return e.result({size:{width:160,height:160},format:e.format}).then(function(t){var a,i;closeModal("#icon-modal"),i=$(".profile-icon"),i.attr("src",t),a=dataURItoBlob(t),a.name="thumbnail."+e.format,n.addFile(a),n.processQueue()}),e.get()}),n=new Dropzone("form#icon-dz",{paramName:"icon",clickable:$("#edit-icon")[0],maxFiles:2,maxFilesize:200,uploadMultiple:!0,createImageThumbnails:!0,autoProcessQueue:!1,acceptedFiles:".jpeg,.jpg,.png",accept:function(e,t){var n;e.acceptDimensions=t,e.rejectDimensions=function(){return t("image must be at least 160 x 160 pixels")},n=e.type,n.equalsIgnoreCase("image/jpg")?t():n.equalsIgnoreCase("image/jpeg")?t():n.equalsIgnoreCase("image/png")?t():t("unable to upload file: "+e.name)},init:function(){return this.on("thumbnail",function(e){e.width<160||e.height<160?e.rejectDimensions():e.acceptDimensions()}),this.on("addedfile",function(e){a(e)})},success:function(){var e;e=$("form#icon-dz"),e.spiffy().enable().loading("header",!1)}}),$(document).on("click","#edit-icon",function(){return n.removeAllFiles(!0)}),a=function(i){var o,s,r;return null==i.accepted?void setTimeout(function(){return a(i)},10):i.accepted?2===n.files.length?(o=$("form#icon-dz"),void o.spiffy().loading("header",!0,5e3)):($(n.element).hide(),openModal("#icon-modal"),r=URL.createObjectURL(i),t=$(".icon-container"),e.bind({url:r}),void(e.format=i.type.equalsIgnoreCase("image/png")?"png":"jpeg")):(o=$(n.element),s=o.find(".message"),s.html("unable to upload file: "+i.name),s.slideDown(),void o.animate({height:"10em"},500))}},initBannerDZ=function(){var e,t;return e=new Dropzone("form#banner-dz",{paramName:"banner",clickable:$("#edit-banner")[0],maxFiles:1,maxFilesize:200,uploadMultiple:!1,createImageThumbnails:!0,autoProcessQueue:!0,acceptedFiles:".jpeg,.jpg,.png",accept:function(e,t){var n;e.acceptDimensions=t,e.rejectDimensions=function(){return t("image must be at least 320 x 180 pixels")},n=e.type,n.equalsIgnoreCase("image/jpg")?t():n.equalsIgnoreCase("image/jpeg")?t():n.equalsIgnoreCase("image/png")?t():t("unable to upload file: "+e.name)},init:function(){return this.on("thumbnail",function(e){e.width<320||e.height<180?e.rejectDimensions():e.acceptDimensions()}),this.on("addedfile",function(e){t(e)})},success:function(){var e;e=$("form#banner-dz"),e.spiffy().enable().loading("header",!1)}}),$(document).on("click","#edit-banner",function(){return e.removeAllFiles(!0)}),t=function(n){var a,i,o,s;return null==n.accepted?void setTimeout(function(){return t(n)},10):n.accepted?(a=$("form#banner-dz"),a.spiffy().loading("header",!0,5e3),s=URL.createObjectURL(n),i=$(".profile-banner"),void i.attr("src",s)):(a=$(e.element),o=a.find(".message"),o.html("unable to upload file: "+n.name),o.slideDown(),void a.animate({height:"10em"},500))}};var addedfile,adjustColumns,closeModal,emptyColumn,fillColumn,fingerprint,load,loadPosts,openModal,sortColumn;$(document).ready(function(){return Spiffy.f.update.poll()}),addedfile=function(e){var t,n,a,i,o,s,r,d,l,f;return null==e.accepted?(a=function(){addedfile(e)},void setTimeout(a,10)):e.accepted?(n=$("form.submit"),s=n.find("div.preview"),t=$(document.createElement("div")),l=URL.createObjectURL(e),n.attr("data-media-src",l),n.attr("data-media-type",e.type),e.type.containsIgnoreCase("video")?(n.spiffy().loading("header",!0,3e4),t.addClass("video"),t.addClass("paused"),f=$(document.createElement("video")),f.attr("autoplay",!0),f.attr("muted",!0),f.attr("loop",!0),f.attr("preload","auto"),f.attr("poster","/static/png/processing.png"),d=$(document.createElement("source")),d.attr("type",e.type),d.attr("src",l),f.append(d),r=$(document.createElement("img")),r.attr("src","/static/png/processing.png"),f.append(r),t.append(f)):e.type.containsIgnoreCase("image")?(n.spiffy().loading("header",!0,5e3),i=$(document.createElement("img")),i.attr("src",l),t.append(i)):(n.spiffy().loading("header",!0,5e3),i=$(document.createElement("img")),i.attr("src","/static/png/processing.png"),t.append(i)),s.prepend(t),$("#file-dz").slideUp(),void n.slideDown()):(n=$("#file-dz"),o=n.find(".message"),o.html("unable to upload file: "+e.name),o.slideDown(),void n.animate({height:"10em"},500))},$(document).ready(function(){var e;return $("form#file-dz").length?e=new Dropzone("form#file-dz",{paramName:"file",maxFiles:1,maxFilesize:200,uploadMultiple:!1,createImageThumbnails:!1,autoProcessQueue:!0,acceptedFiles:".jpeg,.jpg,.png,.gif,.mov,.mp4,.mpeg4,.mpeg,.webm",accept:function(e,t){var n;n=e.type,n.equalsIgnoreCase("image/gif")?t():n.equalsIgnoreCase("image/jpg")?t():n.equalsIgnoreCase("image/jpeg")?t():n.equalsIgnoreCase("image/png")?t():n.equalsIgnoreCase("video/mov")?t():n.equalsIgnoreCase("video/mp4")?t():n.equalsIgnoreCase("video/mpeg4")?t():n.equalsIgnoreCase("video/quicktime")?t():n.equalsIgnoreCase("video/webm")?t():t("unable to upload file: "+e.name)},init:function(){return this.on("addedfile",function(e){addedfile(e)}),this.on("uploadprogress",function(){})},success:function(e,t){var n,a;n=$("form.submit"),n.spiffy().enable().loading("header",!1),a=n.find('input[name="media"]'),a.val(t.name)}}):void 0}),$(document).ready(function(){var e;$(".action-button").click(function(){var e,t;e=$("form.profile-action"),t=e.find('[name="action"]'),t.attr("value",$(this).html()),e.submit()}),$("form.profile-action").spiffy().options({success:function(e){var t,n;t=e.find('[name="action"]'),n=t.attr("value"),$(".action-button").html("FOLLOW".equalsIgnoreCase(n)?"UNFOLLOW":"FOLLOW")}}),$('input[name="fingerprint"]')&&(e=fingerprint(),null!=e&&$('input[name="fingerprint"]').each(function(){$(this).val(e)})),$("[data-unprocessed]").each(function(){var e,t,n,a,i,o,s,r;e=$(this),n=e.data("unprocessed"),o=sessionStorage.getItem("src:"+n),s=sessionStorage.getItem("type:"+n),null!=o&&null!=s&&(s.containsIgnoreCase("video")?(e.addClass("video"),e.addClass("paused"),r=$(document.createElement("video")),r.attr("autoplay",!0),r.attr("muted",!0),r.attr("loop",!0),r.attr("preload","auto"),r.attr("poster","/static/png/processing.png"),i=$(document.createElement("source")),i.attr("type",s),i.attr("src",o),r.append(i),a=$(document.createElement("img")),a.attr("src","/static/png/processing.png"),r.append(a),e.html(r)):s.containsIgnoreCase("image")&&(t=$(document.createElement("img")),t.attr("src",o),e.html(t)))}),$("form:not(.dropzone)").submit(function(e){var t;Spiffy.f.prevent(e),t=$(this),t.spiffy().submit()}),$("form.load-posts").spiffy().options({success:function(e,t){return null==t.posts?e.spiffy().disable():load(t)}}),$("form.forgot").spiffy().options({success:function(e){var t;e.spiffy().disable(),t=e.find("div.message"),t.addClass("success"),t.html("recovery email sent"),t.slideDown()}}),$("form[data-return-uri]").spiffy().options({success:function(e){return go(e.data("return-uri"))}}),$("form.comment").spiffy().options({success:function(){return refresh()}}),$("form.submit").spiffy().options({success:function(e,t){return sessionStorage.setItem("src:"+t.name,e.data("media-src")),sessionStorage.setItem("type:"+t.name,e.data("media-type")),go("/stream/"+t.name)}}),$("a[data-form]").click(function(e){var t;Spiffy.f.prevent(e),t=$("form."+$(this).data("form")),t.submit()}),$("a[data-session-id]").click(function(e){var t;Spiffy.f.prevent(e),t=$("form.logout"),t.find('input[name="session"]').val($(this).data("session-id")),t.submit()}),$("form.logout").spiffy().options({success:function(e){var t,n,a;n=e.find('input[name="session"]'),a=n.val(),t=$('[data-session-id="'+a+'"]'),t.parent().parent().slideUp()}}),$("form.delete").each(function(){$(this).spiffy().options({success:function(){refresh()},confirm:"confirm deletion"})}),$("form.action").spiffy().options({success:function(){go("/")}}),$("div.actions").find("button").each(function(){var e,t;e=$(this),t=e.parents("div.actions:first").find("form"),e.click(function(){var n,a;a=t.find('input[name="action"]'),n=e.data("action"),a.val(n),t.spiffy().options({confirm:"confirm "+n}),t.submit()})}),$('video[data-autoplay="true"]').each(function(){var e;e=$(this),e.is(":in-viewport")&&e.is(":in-viewport("+(e[0].getBoundingClientRect().bottom-e[0].getBoundingClientRect().top)+")")?e[0].paused&&(e[0].play(),e.parents("div.video:first").removeClass("paused")):e[0].paused||(e[0].pause(),e.parents("div.video:first").addClass("paused"))}),$(document).on("click",".thismedia",function(){var e,t,n;t=$(this),t.toggleClass("clicked"),e=$("form.delete"),$("img.thismedia.clicked").length?e.spiffy().enable():e.spiffy().disable(),t.hasClass("clicked")?(n=$(document.createElement("input")),n.attr("type","hidden"),n.attr("name","media"),n.val(t.data("media-name")),e.append(n)):e.find('input[type="hidden"]').each(function(){n=$(this),n.val()===t.data("media-name")&&n.remove()})}),adjustColumns(),$("div.input").each(function(){var e,t,n,a;e=$(this),t=e.find("input"),n=$(document.createElement("label")),n.html(t.attr("placeholder")),e.prepend(n),a=$(document.createElement("span")),a.addClass("bt-flabels__error-desc"),a.html(Spiffy.firstDefined(e.data("error-message"),"error")),e.append(a)})}),openModal=function(e){null==e&&(e=".modal-overlay"),$(e).slideDown(500)},closeModal=function(e){null==e&&(e=".modal-overlay"),$(e).slideUp(250)},fingerprint=function(){var e,t;return e=sessionStorage.getItem("fingerprint"),null!=e?e:(t={excludeAdBlock:!0,excludeAvailableScreenResolution:!0},new Fingerprint2(t).get(function(e){sessionStorage.setItem("fingerprint",e),$('input[name="fingerprint"]').each(function(){$(this).val(e)})}),null)},load=function(e){var t,n;loadPosts(e.posts),t=$("form.load-posts"),n=t.find('input[name="after"]'),n.val(e.next)},loadPosts=function(e){var t,n,a,i,o,s,r,d,l,f,c,u,p,m,g,h;for(s=l=0,p=e.length;p>=0?p>l:l>p;s=p>=0?++l:--l)u=e[s],c=$(document.createElement("div")),c.addClass("panel"),c.attr("data-post-id",u.postId),t=$(document.createElement("div")),t.addClass("centeryo"),o=$(document.createElement("div")),o.addClass("mediayo"),i=u.content,i.type.equalsIgnoreCase("video")?(o.addClass("video"),o.addClass("paused"),h=$(document.createElement("video")),h.attr("muted",!0),h.attr("loop",!0),h.attr("poster",i.poster.file),m=$(document.createElement("source")),m.attr("src",i.mp4),m.attr("type","video/mp4"),h.append(m),m=$(document.createElement("source")),m.attr("src",i.webm),m.attr("type","video/webm"),h.append(m),null!=i.gif&&(r=$(document.createElement("img")),r.attr("src",i.gif),h.append(r)),o.prepend(h)):i.type.equalsIgnoreCase("image")?(r=$(document.createElement("img")),r.attr("src",i.medium),o.prepend(r)):(g=Handlebars.compile($('[data-template="panel-ad"]').html()),o.append(g({}))),t.html(o),c.prepend(t),g=i.type.equalsIgnoreCase("ad")?Handlebars.compile($('[data-template="panel-ad-source"]').html()):Handlebars.compile($('[data-template="panel-source"]').html()),c.append(g({post:u})),a=3,$(window).width()<Spiffy.c.size.width.XL&&(a=2),$(window).width()<Spiffy.c.size.width.MD&&(a=1),n=$('.col[data-index="'+s%a+'"]'),f=n.find(".panel:last"),d=null!=f&&f.is(".panel")?f.data("index")+a:n.data("index"),c.attr("data-index",d),n.append(c),i.type.equalsIgnoreCase("ad")&&(adsbygoogle=window.adsbygoogle||[]).push({})},adjustColumns=function(){var e,t,n,a;$(".col").each(function(e){var t;$(this).attr("data-index",e),t=e,$(this).find(".panel").each(function(e){$(this).attr("data-index",$(".col").length*e+t)})}),t=$("form.load-posts"),null!=t&&t.is("form.load-posts")&&(e=$('.col[data-index="2"]'),a=e.find(".panel:last"),a.data("post-id").equalsIgnoreCase("ad")&&(e=$('.col[data-index="1"]'),a=e.find(".panel:last")),$('.col[data-index="0"]').find(".panel").length>$('.col[data-index="1"]').find(".panel").length&&(e=$('.col[data-index="0"]'),a=e.find(".panel:last")),n=t.find('input[name="after"]'),n.val(a.data("post-id"))),$(window).width()<Spiffy.c.size.width.XL&&emptyColumn(2),$(window).width()<Spiffy.c.size.width.MD&&emptyColumn(1)},emptyColumn=function(e){var t,n;t=$('.col[data-index="'+e+'"]'),n=t.find(".panel"),n.length&&(n.each(function(){var t,n;n=$(this),t=n.data("index"),t=1===e||t%2===0?t-1:t-2,n.detach().insertAfter('.panel[data-index="'+t+'"]')}),sortColumn(1))},fillColumn=function(e,t){var n,a;n=$('.col[data-index="'+e+'"]'),a=n.find(".panel"),a.length||(n=$('.col[data-index!="'+e+'"]'),a=n.find(".panel"),a.each(function(){var n;n=$(this),n.data("index")%t===e&&n.detach().appendTo('.col[data-index="'+e+'"]')}),sortColumn(e))},sortColumn=function(e){var t,n,a;t=$('.col[data-index="'+e+'"]'),n=t.find(".panel"),a=n.sort(function(e,t){return $(e).data("index")-$(t).data("index")}),t.html(a)},$(window).resize(function(){var e;e=$(window).width(),e>window.pWidth&&e>=Spiffy.c.size.width.MD&&($(".subheader").show(),fillColumn(1,2)),e<window.pWidth&&e<Spiffy.c.size.width.MD&&($(".subheader").hide(),$(".hamburger").removeClass("active"),emptyColumn(1)),e>window.pWidth&&e>=Spiffy.c.size.width.XL&&(emptyColumn(1),fillColumn(1,3),fillColumn(2,3)),e<window.pWidth&&e<Spiffy.c.size.width.XL&&emptyColumn(2),window.pWidth=e}),$(window).scroll(function(){$("video").each(function(){var e,t,n;n=$(this),n.data("clicked")||(t=n[0].getBoundingClientRect().top,e=n.parents(".panel:first").find(".source"),75>t||!n.is(":in-viewport")||!e.is(":in-viewport")?n[0].paused||(n[0].pause(),n.parents("div.video:first").addClass("paused")):n[0].paused&&(n[0].play(),n[0].paused||n.parents("div.video:first").removeClass("paused")))})}),$(document).ready(function(){var e;return e=location.href,e.endsWith("#")&&history.replaceState({},document.title,e.substring(0,e.length-1)),$(window).scroll(function(){$("div.col").each(function(){var e,t,n;e=$(this),n=e.find("div.panel:last"),null!=n&&n.is(":in-viewport")&&(t=$("form.load-posts"),t.submit())})})}),function(e){"use strict";var t;t=function(t){var n;n=e(this),t&&e.each(e(".input input"),function(t,n){var a;a=e(n),a.val()&&a.closest(".input").addClass("bt-flabel__float")}),setTimeout(function(){n.val()?n.closest(".input").addClass("bt-flabel__float"):n.closest(".input").removeClass("bt-flabel__float")},1)},e(".input input").keydown(t),e(".input input").change(t),window.addEventListener("load",t(!0),!1),e("form").each(function(){var t;return t=e(this),t.find("input").length?(t.attr("data-parsley-errors-messages-disabled",""),t.parsley().on("form:error",function(){e.each(this.fields,function(e,t){var n,a;t.validationResult!==!0&&(a=t.validationResult[0].assert.name,a.equalsIgnoreCase("type")?a="invalid "+t.validationResult[0].assert.requirements:a.equalsIgnoreCase("equalto")&&(a="unmatched "+t.$element.parents("form:first").find(t.validationResult[0].assert.requirements).attr("placeholder")),n=t.$element.parent(),n.find("span").html(a),n.addClass("bt-flabels__error"))})}),t.parsley().on("field:validated",function(){var e;this.validationResult===!0?(e=this.$element.parent(),e.removeClass("bt-flabels__error")):(e=this.$element.parent(),e.addClass("bt-flabels__error"))})):void 0})}(jQuery);
