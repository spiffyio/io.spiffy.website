var Spiffy;Spiffy={},Spiffy.constants={},Spiffy.c=Spiffy.constants,Spiffy.c["enum"]={},Spiffy.c["enum"].loglevel={FATAL:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},Spiffy.c.param={ATTEMPT:1,ETAG:void 0},Spiffy.c.retry={MAX_COUNT:3,TIMEOUT:5e3},Spiffy.c.key={LEFT:37,RIGHT:39},Spiffy.c.size={},Spiffy.c.size.width={XS:320,SM:480,MD:768,LG:992,XL:120},Spiffy.c.config={CDN:"//cdn.spiffy.io",LOGLEVEL:Spiffy.c["enum"].loglevel.TRACE};var confirmation,dataURItoBlob,defined,go,handler,initModalSize,overrideHandler,preventDefault,refresh;Spiffy.functions={},Spiffy.f=Spiffy.functions,Spiffy.f.log=function(f,e){f<=Spiffy.c.config.LOGLEVEL&&console.log(e)},Spiffy.f.authenticated=function(){return 0!==$('meta[name="account"]').length},Spiffy.f.first=function(){var f,e,i;for(i=arguments.length-1;i>=0;i+=-1)f=arguments[i],null!=f&&(e=f);return e},Spiffy.f.firstDefined=Spiffy.f.first,Spiffy.firstDefined=Spiffy.f.firstDefined,Spiffy.f.click=function(f,e,i){null==i&&(i=!0),$(document).on("click",f,function(f){i&&Spiffy.f.prevent(f),e(f,$(this))})},Spiffy.f.prevent=function(f){f.preventDefault()},Spiffy.f.element={},Spiffy.f.element.template=function(f){var e;return e='[data-template="$name"]'.replace("$name",f),$(e)},Spiffy.f.timeout={},Spiffy.f.timeout.simple=function(f,e){setTimeout(e,f)},Spiffy.f.timeout.retry=function(f,e){return f>=Spiffy.c.retry.MAX_COUNT?void Spiffy.f.log(Spiffy.c["enum"].loglevel.ERROR,"max retry attempts exceeded... "+e):void setTimeout(e,Spiffy.c.retry.TIMEOUT*f*f)},Spiffy.f.update={},Spiffy.f.update.notifications=function(f){var e;e=$("span.notification-count"),0===f?(document.title="SPIFFY.io",e.html("")):(document.title="("+f+") SPIFFY.io",e.html(f))},Spiffy.f.update.poll=function(f,e){return null==f&&(f=Spiffy.c.param.ETAG),null==e&&(e=Spiffy.c.param.ATTEMPT),Spiffy.f.authenticated()?(Spiffy.f.log(Spiffy.c["enum"].loglevel.INFO,"polling..."+(null!=f?" [etag: "+f+"]":"")),$.get({url:"/longpoll",dataType:"json",cache:!1,beforeSend:function(e){null!=f&&e.setRequestHeader("If-None-Match",f)},success:function(f,e,i){Spiffy.f.update.notifications(f.notifications),Spiffy.f.update.poll(i.getResponseHeader("ETag"))},error:function(){Spiffy.f.timeout.retry(e,function(){Spiffy.f.update.poll(f,e+1)})}})):void Spiffy.f.log(Spiffy.c["enum"].loglevel.INFO,"polling disabled...")},preventDefault=function(f){Spiffy.f.prevent(f)},overrideHandler=refresh,handler=function(f){return defined(f)&&(overrideHandler=f),defined(overrideHandler)?overrideHandler:refresh},confirmation=function(f,e){var i;i=$("#confirmation"),i.find(".modal-title").text(f),i.find(".continue").on("click",function(f){return Spiffy.f.prevent(f),e()}),i.modal("show")},go=function(f){return location.href=f},refresh=function(){return location.reload(!0),window.location=self.location},defined=function(f){return"undefined"==typeof f?!1:"undefined"!==f},initModalSize=function(){var f;return f=$(window).height()-125+"px",$(".modal-body").css("max-height",f),f},dataURItoBlob=function(f){var e,i,n,t,o,a,r,l,c,p,u;for(p=f.split(","),l=p[0],t=p[1],e=l.containsIgnoreCase("base64")?atob(t):unescape(t),c=l.split(":")[1].split(";")[0],i=new Uint8Array(e.length),u=e.split(""),o=a=0,r=u.length;r>a;o=++a)n=u[o],i[o]=n.charCodeAt(0);return new Blob([i],{type:c})},Spiffy.f.click('a[href="#"]',function(){return{}}),Spiffy.f.click("a.menu",function(f,e){var i;e.toggleClass("expanded"),i=e.parent().find(".sub-menu"),i.toggleClass("show")}),Spiffy.f.click("[data-go]",function(f,e){go(e.data("go")+location.search)}),Spiffy.f.click(".close",function(){closeModal()}),Spiffy.f.click(".modal-overlay",function(f){$(f.target).hasClass("modal-overlay")&&closeModal()}),Spiffy.f.click("div.pause, video",function(f,e){var i;i=e.parent().parent().find("video"),i.attr("data-clicked",!0),i[0].paused?(i[0].play(),i.parents("div.video:first").removeClass("paused")):(i[0].pause(),i.parents("div.video:first").addClass("paused"))});
