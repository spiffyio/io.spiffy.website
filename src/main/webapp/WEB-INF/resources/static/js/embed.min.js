var Spiffy;Spiffy={},Spiffy.constants={},Spiffy.c=Spiffy.constants,Spiffy.c["enum"]={},Spiffy.c["enum"].loglevel={FATAL:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5},Spiffy.c.param={ATTEMPT:1,ETAG:void 0},Spiffy.c.retry={MAX_COUNT:3,TIMEOUT:5e3},Spiffy.c.key={LEFT:37,RIGHT:39},Spiffy.c.size={},Spiffy.c.size.width={XS:320,SM:480,MD:768,LG:992,XL:120},Spiffy.c.config={CDN:"//cdn.spiffy.io",LOGLEVEL:Spiffy.c["enum"].loglevel.TRACE};var confirmation,dataURItoBlob,defined,go,handler,initModalSize,overrideHandler,preventDefault,refresh;Spiffy.functions={},Spiffy.f=Spiffy.functions,Spiffy.f.log=function(e,t){e<=Spiffy.c.config.LOGLEVEL&&console.log(t)},Spiffy.f.authenticated=function(){return 0!==$('meta[name="account"]').length},Spiffy.f.first=function(){var e,t,n;for(n=arguments.length-1;n>=0;n+=-1)e=arguments[n],null!=e&&(t=e);return t},Spiffy.f.firstDefined=Spiffy.f.first,Spiffy.firstDefined=Spiffy.f.firstDefined,Spiffy.f.click=function(e,t,n){null==n&&(n=!0),$(document).on("click",e,function(e){n&&Spiffy.f.prevent(e),t(e,$(this))})},Spiffy.f.prevent=function(e){e.preventDefault()},Spiffy.f.element={},Spiffy.f.element.template=function(e){var t;return t='[data-template="$name"]'.replace("$name",e),$(t)},Spiffy.f.timeout={},Spiffy.f.timeout.simple=function(e,t){setTimeout(t,e)},Spiffy.f.timeout.retry=function(e,t){return e>=Spiffy.c.retry.MAX_COUNT?void Spiffy.f.log(Spiffy.c["enum"].loglevel.ERROR,"max retry attempts exceeded... "+t):void setTimeout(t,Spiffy.c.retry.TIMEOUT*e*e)},Spiffy.f.update={},Spiffy.f.update.notifications=function(e){var t;t=$("span.notification-count"),0===e?(document.title="SPIFFY.io",t.html("")):(document.title="("+e+") SPIFFY.io",t.html(e))},Spiffy.f.update.poll=function(e,t){return null==e&&(e=Spiffy.c.param.ETAG),null==t&&(t=Spiffy.c.param.ATTEMPT),Spiffy.f.authenticated()?(Spiffy.f.log(Spiffy.c["enum"].loglevel.INFO,"polling..."+(null!=e?" [etag: "+e+"]":"")),$.get({url:"/longpoll",dataType:"json",cache:!1,beforeSend:function(t){null!=e&&t.setRequestHeader("If-None-Match",e)},success:function(e,t,n){Spiffy.f.update.notifications(e.notifications),Spiffy.f.update.poll(n.getResponseHeader("ETag"))},error:function(){Spiffy.f.timeout.retry(t,function(){Spiffy.f.update.poll(e,t+1)})}})):void Spiffy.f.log(Spiffy.c["enum"].loglevel.INFO,"polling disabled...")},preventDefault=function(e){Spiffy.f.prevent(e)},overrideHandler=refresh,handler=function(e){return defined(e)&&(overrideHandler=e),defined(overrideHandler)?overrideHandler:refresh},confirmation=function(e,t){var n;n=$("#confirmation"),n.find(".modal-title").text(e),n.find(".continue").on("click",function(e){return Spiffy.f.prevent(e),t()}),n.modal("show")},go=function(e){return location.href=e},refresh=function(){return location.reload(!0),window.location=self.location},defined=function(e){return"undefined"==typeof e?!1:"undefined"!==e},initModalSize=function(){var e;return e=$(window).height()-125+"px",$(".modal-body").css("max-height",e),e},dataURItoBlob=function(e){var t,n,a,i,o,s,r,d,l,f,c;for(f=e.split(","),d=f[0],i=f[1],t=d.containsIgnoreCase("base64")?atob(i):unescape(i),l=d.split(":")[1].split(";")[0],n=new Uint8Array(t.length),c=t.split(""),o=s=0,r=c.length;r>s;o=++s)a=c[o],n[o]=a.charCodeAt(0);return new Blob([n],{type:l})},Spiffy.f.click('a[href="#"]',function(){return{}}),Spiffy.f.click("a.menu",function(e,t){var n;t.toggleClass("expanded"),n=t.parent().find(".sub-menu"),n.toggleClass("show")}),Spiffy.f.click("[data-go]",function(e,t){go(t.data("go")+location.search)}),Spiffy.f.click(".close",function(){closeModal()}),Spiffy.f.click(".modal-overlay",function(e){$(e.target).hasClass("modal-overlay")&&closeModal()}),Spiffy.f.click("div.pause, video",function(e,t){var n;n=t.parent().parent().find("video"),n.attr("data-clicked",!0),n[0].paused?(n[0].play(),n.parents("div.video:first").removeClass("paused")):(n[0].pause(),n.parents("div.video:first").addClass("paused"))});
